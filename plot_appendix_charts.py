import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

# This python script is used to COMPUTE GRANULAR RESULTS for the Appendix

# THE FOLLOWING 4 DICTIONARIES WERE OBTAINED COMBINING ALL IDENTITIES IN ONE DICTIONARY PER EACH MODEL

FINAL_bert_ear_reg_0_00 = {'subgroup_AUC': [('lesbian', 0.9172932330827068), ('gay', 0.5563909774436091), ('bisexual', 0.9962406015037594), ('transgender', 0.9210526315789473), ('trans', 0.9454887218045113), ('queer', 0.8609022556390977), ('lgbt', 0.9661654135338346), ('lgbtq', 0.9360902255639098), ('homosexual', 0.5075187969924813), ('straight', 0.9624060150375939), ('heterosexual', 0.8609022556390977), ('male', 0.9887218045112782), ('female', 0.9887218045112782), ('nonbinary', 0.924812030075188), ('african', 0.9718045112781954), ('african american', 0.9624060150375939), ('black', 0.9661654135338346), ('white', 0.9699248120300752), ('european', 0.981203007518797), ('hispanic', 0.9586466165413534), ('latino', 0.9774436090225564), ('latina', 0.8909774436090225), ('latinx', 0.9473684210526316), ('mexican', 1.0), ('canadian', 0.9624060150375939), ('american', 0.9736842105263157), ('asian', 0.9511278195488722), ('indian', 0.9849624060150376), ('middle eastern', 0.887218045112782), ('chinese', 0.9849624060150376), ('japanese', 0.981203007518797), ('christian', 0.9060150375939849), ('muslim', 0.9924812030075187), ('jewish', 1.0), ('buddhist', 0.9774436090225564), ('catholic', 0.887218045112782), ('protestant', 0.9398496240601504), ('sikh', 0.9699248120300752), ('taoist', 0.9473684210526316), ('old', 0.9172932330827068), ('older', 0.8947368421052632), ('young', 0.9210526315789473), ('younger', 0.9097744360902256), ('teenage', 0.9887218045112782), ('millenial', 0.8646616541353384), ('middle aged', 0.9398496240601504), ('elderly', 0.9661654135338346), ('blind', 0.9887218045112781), ('deaf', 0.7330827067669172), ('paralyzed', 0.981203007518797)], 'BPSN_AUC': [('lesbian', 0.8987854251012146), ('gay', 0.5378831694621169), ('bisexual', 0.9817813765182186), ('transgender', 0.9025448235974551), ('trans', 0.9429824561403508), ('queer', 0.8423944476576055), ('lgbt', 0.9855889724310777), ('lgbtq', 0.9864083285135916), ('homosexual', 0.489010989010989), ('straight', 0.9843840370156159), ('heterosexual', 0.8464430306535569), ('male', 0.981829573934837), ('female', 0.9823597455176403), ('nonbinary', 0.9872758820127241), ('african', 0.9641604010025062), ('african american', 0.9652255639097744), ('black', 0.9290413533834586), ('white', 0.9647556390977443), ('european', 0.9640507518796992), ('hispanic', 0.9654605263157895), ('latino', 0.9642857142857143), ('latina', 0.9696898496240601), ('latinx', 0.9661654135338346), ('mexican', 0.962875939849624), ('canadian', 0.9652255639097744), (
    'american', 0.9639097744360903), ('asian', 0.9659304511278195), ('indian', 0.9638157894736843), ('middle eastern', 0.9699248120300752), ('chinese', 0.9638157894736843), ('japanese', 0.9640507518796992), ('christian', 0.9597207303974221), ('muslim', 0.9430719656283565), ('jewish', 0.9462943071965628), ('buddhist', 0.949516648764769), ('catholic', 0.9624060150375939), ('protestant', 0.9548872180451128), ('sikh', 0.9505907626208379), ('taoist', 0.9538131041890441), ('old', 0.9532163742690059), ('older', 0.9518796992481203), ('young', 0.9523809523809523), ('younger', 0.9503759398496241), ('teenage', 0.9424812030075188), ('millenial', 0.9548872180451128), ('middle aged', 0.9473684210526316), ('elderly', 0.9447368421052631), ('blind', 0.9342105263157894), ('deaf', 0.674436090225564), ('paralyzed', 0.943233082706767)], 'BNSP_AUC': [('lesbian', 0.9008097165991903), ('gay', 0.9285714285714286), ('bisexual', 0.8906882591093117), ('transgender', 0.9005205320994795), ('trans', 0.8771929824561403), ('queer', 0.9051474840948526), ('lgbt', 0.8518170426065163), ('lgbtq', 0.8305378831694621), ('homosexual', 0.9323308270676691), ('straight', 0.8568536726431463), ('heterosexual', 0.9010989010989011), ('male', 0.8743734335839599), ('female', 0.8831694621168305), ('nonbinary', 0.8192596876807403), ('african', 0.969548872180451), ('african american', 0.9602913533834586), ('black', 1.0), ('white', 0.9678101503759399), ('european', 0.9790883458646616), ('hispanic', 0.9565319548872182), ('latino', 0.9753289473684211), ('latina', 0.8888627819548872), ('latinx', 0.9452537593984963), ('mexican', 0.9978853383458647), ('canadian', 0.9602913533834586), ('american', 0.9714285714285714), ('asian', 0.9490131578947368), ('indian', 0.9828477443609023), ('middle eastern', 0.8851033834586467), ('chinese', 0.9828477443609023), ('japanese', 0.9790883458646616), ('christian', 0.9054779806659506), ('muslim', 0.9962406015037594), ('jewish', 0.9994629430719657), ('buddhist', 0.9769065520945222), ('catholic', 0.8866809881847477), ('protestant', 0.9393125671321161), ('sikh', 0.9693877551020408), ('taoist', 0.9468313641245972), ('old', 0.8868003341687551), ('older', 0.8672932330827068), ('young', 0.8905597326649958), ('younger', 0.8823308270676692), ('teenage', 0.9612781954887218), ('millenial', 0.837218045112782), ('middle aged', 0.912406015037594), ('elderly', 0.9387218045112782), ('blind', 0.969548872180451), ('deaf', 0.9992481203007519), ('paralyzed', 0.9537593984962406)]}


FINAL_bert_ear_reg_0_01 = {'subgroup_AUC': [('lesbian', 0.8909774436090225), ('gay', 0.6428571428571428), ('bisexual', 0.9774436090225563), ('transgender', 0.9398496240601503), ('trans', 0.9530075187969925), ('queer', 0.5338345864661654), ('lgbt', 0.9868421052631579), ('lgbtq', 0.981203007518797), ('homosexual', 0.5037593984962406), ('straight', 0.9586466165413534), ('heterosexual', 0.9285714285714285), ('male', 0.9924812030075187), ('female', 0.9924812030075187), ('nonbinary', 0.9548872180451128), ('african', 0.9943609022556391), ('african american', 0.9962406015037594), ('black', 0.9548872180451128), ('white', 0.9774436090225563), ('european', 0.9699248120300752), ('hispanic', 0.9887218045112782), ('latino', 0.9849624060150376), ('latina', 0.9849624060150376), ('latinx', 0.981203007518797), ('mexican', 0.9887218045112781), ('canadian', 0.9736842105263157), ('american', 0.9943609022556391), ('asian', 0.9887218045112781), ('indian', 0.9887218045112781), ('middle eastern', 0.981203007518797), ('chinese', 0.9962406015037594), ('japanese', 0.9887218045112782), ('christian', 0.981203007518797), ('muslim', 0.9924812030075187), ('jewish', 0.9924812030075187), ('buddhist', 0.9887218045112782), ('catholic', 0.9924812030075187), ('protestant', 0.9849624060150376), ('sikh', 0.9887218045112782), ('taoist', 0.9774436090225564), ('old', 0.9417293233082705), ('older', 0.9135338345864661), ('young', 0.9492481203007519), ('younger', 0.9323308270676691), ('teenage', 0.9887218045112781), ('millenial', 0.9060150375939849), ('middle aged', 0.9849624060150376), ('elderly', 0.981203007518797), ('blind', 0.9360902255639098), ('deaf', 0.868421052631579), ('paralyzed', 0.9285714285714286)], 'BPSN_AUC': [('lesbian', 0.8779641411220357), ('gay', 0.6298438403701562), ('bisexual', 0.9725274725274725), ('transgender', 0.9349334875650666), ('trans', 0.9630325814536342), ('queer', 0.5208212839791787), ('lgbt', 0.9859022556390976), ('lgbtq', 0.9884326200115674), ('homosexual', 0.49074609600925395), ('straight', 0.9901677270098324), ('heterosexual', 0.9196067090803932), ('male', 0.9827694235588972), ('female', 0.9835164835164835), ('nonbinary', 0.9904569115095431), ('african', 0.982456140350877), ('african american', 0.9830827067669173), ('black', 0.9537124060150376), ('white', 0.9842575187969925), ('european', 0.9887218045112782), ('hispanic', 0.987546992481203), ('latino', 0.987781954887218), ('latina', 0.987781954887218), ('latinx', 0.9880169172932332), ('mexican', 0.9835526315789473), (
    'canadian', 0.9884868421052632), ('american', 0.9845864661654136), ('asian', 0.9835526315789473), ('indian', 0.9835526315789473), ('middle eastern', 0.9880169172932332), ('chinese', 0.9830827067669173), ('japanese', 0.987546992481203), ('christian', 0.9892588614393125), ('muslim', 0.9833512352309344), ('jewish', 0.9833512352309344), ('buddhist', 0.9881847475832438), ('catholic', 0.9876476906552094), ('protestant', 0.9887218045112782), ('sikh', 0.9881847475832438), ('taoist', 0.9897959183673469), ('old', 0.9678362573099415), ('older', 0.9721804511278196), ('young', 0.9707602339181287), ('younger', 0.9703007518796993), ('teenage', 0.9605263157894736), ('millenial', 0.9729323308270676), ('middle aged', 0.9650375939849625), ('elderly', 0.9654135338345864), ('blind', 0.9037593984962407), ('deaf', 0.8319548872180451), ('paralyzed', 0.9086466165413535)], 'BNSP_AUC': [('lesbian', 0.887218045112782), ('gay', 0.9063042220936958), ('bisexual', 0.8724696356275303), ('transgender', 0.8753614806246386), ('trans', 0.8524436090225563), ('queer', 0.9146905725853095), ('lgbt', 0.8577694235588973), ('lgbtq', 0.8600347021399652), ('homosexual', 0.917004048582996), ('straight', 0.8374783111625217), ('heterosexual', 0.8802776171197224), ('male', 0.8656015037593985), ('female', 0.8753614806246385), ('nonbinary', 0.8337189126662811), ('african', 0.9946115288220552), ('african american', 0.9964755639097744), ('black', 0.9870770676691729), ('white', 0.9776785714285714), ('european', 0.9661654135338346), ('hispanic', 0.9849624060150376), ('latino', 0.9812030075187969), ('latina', 0.9812030075187969), ('latinx', 0.9774436090225563), ('mexican', 0.9889567669172932), ('canadian', 0.969924812030075), ('american', 0.9924812030075187), ('asian', 0.9889567669172932), ('indian', 0.9889567669172932), ('middle eastern', 0.9774436090225563), ('chinese', 0.9964755639097744), ('japanese', 0.9849624060150376), ('christian', 0.9801288936627282), ('muslim', 0.9957035445757251), ('jewish', 0.9957035445757251), ('buddhist', 0.9876476906552095), ('catholic', 0.9914070891514499), ('protestant', 0.9838882921589688), ('sikh', 0.9876476906552095), ('taoist', 0.9763694951664877), ('old', 0.9175020885547202), ('older', 0.8875939849624059), ('young', 0.9204260651629073), ('younger', 0.906390977443609), ('teenage', 0.9669172932330827), ('millenial', 0.8800751879699248), ('middle aged', 0.9590225563909774), ('elderly', 0.9552631578947368), ('blind', 0.9763157894736841), ('deaf', 0.9872180451127819), ('paralyzed', 0.9646616541353382)]}

FINAL_xlnet_ear_reg_0_00 = {'subgroup_AUC': [('lesbian', 0.6616541353383458), ('gay', 0.5075187969924813), ('bisexual', 0.5526315789473684), ('transgender', 0.6992481203007519), ('trans', 0.8233082706766917), ('queer', 0.5864661654135338), ('lgbt', 0.9774436090225564), ('lgbtq', 0.9774436090225564), ('homosexual', 0.5), ('straight', 0.9586466165413533), ('heterosexual', 0.6015037593984962), ('male', 0.9812030075187971), ('female', 0.9849624060150376), ('nonbinary', 0.9661654135338346), ('african', 0.9774436090225563), ('african american', 0.981203007518797), ('black', 0.7969924812030076), ('white', 0.9699248120300752), ('european', 0.9736842105263157), ('hispanic', 0.9699248120300752), ('latino', 0.9473684210526316), ('latina', 0.9473684210526316), ('latinx', 0.9661654135338344), ('mexican', 0.9699248120300752), ('canadian', 0.9736842105263157), ('american', 0.981203007518797), ('asian', 0.9135338345864661), ('indian', 0.9661654135338347), ('middle eastern', 0.9548872180451127), ('chinese', 0.9774436090225564), ('japanese', 0.9736842105263157), ('christian', 0.9887218045112782), ('muslim', 0.9736842105263158), ('jewish', 0.8571428571428572), ('buddhist', 0.9774436090225564), ('catholic', 0.93609022556391), ('protestant', 0.969924812030075), ('sikh', 0.9774436090225564), ('taoist', 0.906015037593985), ('old', 0.9699248120300752), ('older', 0.9624060150375939), ('young', 0.9718045112781954), ('younger', 0.9586466165413534), ('teenage', 0.9548872180451128), ('millenial', 0.9736842105263157), ('middle aged', 0.9736842105263158), ('elderly', 0.981203007518797), ('blind', 0.7819548872180451), ('deaf', 0.612781954887218), ('paralyzed', 0.6278195488721805)], 'BPSN_AUC': [('lesbian', 0.6474840948525158), ('gay', 0.4933487565066512), ('bisexual', 0.5384615384615384), ('transgender', 0.6931752458068248), ('trans', 0.8342731829573934), ('queer', 0.5803932909196068), ('lgbt', 0.9884085213032581), ('lgbtq', 0.9875650665124349), ('homosexual', 0.48582995951417), ('straight', 0.9728166570271833), ('heterosexual', 0.5954308849045691), ('male', 0.9790100250626567), ('female', 0.9829381145170618), ('nonbinary', 0.9843840370156159), ('african', 0.9765664160401002), ('african american', 0.9783834586466165), ('black', 0.7861842105263159), ('white', 0.9671052631578947), ('european', 0.9788533834586466), ('hispanic', 0.9631109022556391), ('latino', 0.9485432330827068), ('latina', 0.9405545112781956), ('latinx', 0.9593515037593985), ('mexican', 0.9790883458646616), ('canadian', 0.9788533834586466), (
    'american', 0.9781954887218045), ('asian', 0.918703007518797), ('indian', 0.9673402255639099), ('middle eastern', 0.9600563909774436), ('chinese', 0.9786184210526316), ('japanese', 0.9788533834586466), ('christian', 0.976906552094522), ('muslim', 0.9747583243823845), ('jewish', 0.8582169709989259), ('buddhist', 0.9785177228786252), ('catholic', 0.9371643394199786), ('protestant', 0.9752953813104188), ('sikh', 0.9785177228786252), ('taoist', 0.9070891514500539), ('old', 0.9809941520467836), ('older', 0.9827067669172933), ('young', 0.9828738512949039), ('younger', 0.9830827067669172), ('teenage', 0.9462406015037593), ('millenial', 0.9815789473684211), ('middle aged', 0.9774436090225563), ('elderly', 0.9808270676691729), ('blind', 0.7691729323308271), ('deaf', 0.5958646616541354), ('paralyzed', 0.6150375939849624)], 'BNSP_AUC': [('lesbian', 0.8016194331983806), ('gay', 0.813475997686524), ('bisexual', 0.8100057836899942), ('transgender', 0.7906304222093695), ('trans', 0.7600250626566416), ('queer', 0.799305957200694), ('lgbt', 0.7343358395989975), ('lgbtq', 0.7530364372469636), ('homosexual', 0.8140543666859457), ('straight', 0.7504337767495661), ('heterosexual', 0.7981492192018507), ('male', 0.7468671679197996), ('female', 0.7646038172353962), ('nonbinary', 0.7458068247541932), ('african', 0.9530075187969925), ('african american', 0.9562969924812029), ('black', 0.9757988721804511), ('white', 0.9570018796992481), ('european', 0.9487781954887217), ('hispanic', 0.9609962406015037), ('latino', 0.9544172932330828), ('latina', 0.962406015037594), ('latinx', 0.9612312030075187), ('mexican', 0.9450187969924813), ('canadian', 0.9487781954887217), ('american', 0.9546365914786967), ('asian', 0.9525375939849624), ('indian', 0.9532424812030076), ('middle eastern', 0.949953007518797), ('chinese', 0.9525375939849625), ('japanese', 0.9487781954887217), ('christian', 0.9543501611170784), ('muslim', 0.943609022556391), ('jewish', 0.9602577873254566), ('buddhist', 0.9430719656283566), ('catholic', 0.9489795918367347), ('protestant', 0.9398496240601503), ('sikh', 0.9430719656283566), ('taoist', 0.9532760472610098), ('old', 0.8611111111111109), ('older', 0.8624060150375941), ('young', 0.8606934001670843), ('younger', 0.8586466165413534), ('teenage', 0.8921052631578947), ('millenial', 0.8736842105263157), ('middle aged', 0.8778195488721805), ('elderly', 0.8812030075187971), ('blind', 0.9135338345864661), ('deaf', 0.9345864661654135), ('paralyzed', 0.9289473684210525)]}


FINAL_xlnet_ear_reg_0_01 = {'subgroup_AUC': [('lesbian', 0.8533834586466166), ('gay', 0.6992481203007519), ('bisexual', 0.8984962406015038), ('transgender', 0.8984962406015038), ('trans', 0.9135338345864661), ('queer', 0.5939849624060151), ('lgbt', 0.9229323308270676), ('lgbtq', 0.9172932330827067), ('homosexual', 0.5037593984962406), ('straight', 0.8759398496240601), ('heterosexual', 0.868421052631579), ('male', 0.981203007518797), ('female', 0.9924812030075187), ('nonbinary', 0.9135338345864661), ('african', 0.9680451127819549), ('african american', 0.9624060150375939), ('black', 0.9360902255639098), ('white', 0.9060150375939849), ('european', 0.9624060150375939), ('hispanic', 0.8609022556390977), ('latino', 0.9210526315789475), ('latina', 0.9022556390977443), ('latinx', 0.9097744360902256), ('mexican', 0.9060150375939849), ('canadian', 0.9398496240601503), ('american', 0.9736842105263158), ('asian', 0.9285714285714285), ('indian', 0.951127819548872), ('middle eastern', 0.87593984962406), ('chinese', 0.9661654135338346), ('japanese', 0.9285714285714285), ('christian', 0.9774436090225564), ('muslim', 0.9511278195488723), ('jewish', 0.9097744360902255), ('buddhist', 0.9360902255639098), ('catholic', 0.8947368421052632), ('protestant', 0.9248120300751879), ('sikh', 0.9661654135338347), ('taoist', 0.9060150375939849), ('old', 0.8759398496240602), ('older', 0.8646616541353384), ('young', 0.8909774436090225), ('younger', 0.8796992481203008), ('teenage', 0.9548872180451128), ('millenial', 0.8721804511278194), ('middle aged', 0.8796992481203008), ('elderly', 0.9436090225563909), ('blind', 0.9285714285714284), ('deaf', 0.9022556390977443), ('paralyzed', 0.9022556390977443)], 'BPSN_AUC': [('lesbian', 0.8241758241758242), ('gay', 0.6700404858299596), ('bisexual', 0.8692886061307115), ('transgender', 0.8692886061307115), ('trans', 0.919172932330827), ('queer', 0.5647773279352226), ('lgbt', 0.9548872180451128), ('lgbtq', 0.9609600925390399), ('homosexual', 0.47455176402544824), ('straight', 0.9762868710237129), ('heterosexual', 0.8392134181607868), ('male', 0.9495614035087718), ('female', 0.9632735685367264), ('nonbinary', 0.9774436090225564), ('african', 0.9106516290726817), ('african american', 0.9046052631578948), ('black', 0.8982612781954887), ('white', 0.9241071428571428), ('european', 0.9405545112781953), ('hispanic', 0.9508928571428572), ('latino', 0.90718984962406), ('latina', 0.9363251879699248), ('latinx', 0.9039003759398496), ('mexican', 0.9480733082706767), (
    'canadian', 0.9419642857142856), ('american', 0.918421052631579), ('asian', 0.9306860902255639), ('indian', 0.9412593984962405), ('middle eastern', 0.9419642857142857), ('chinese', 0.9403195488721803), ('japanese', 0.9426691729323308), ('christian', 0.9215896885069818), ('muslim', 0.9210526315789475), ('jewish', 0.9355531686358753), ('buddhist', 0.9360902255639098), ('catholic', 0.9591836734693877), ('protestant', 0.9334049409237379), ('sikh', 0.9360902255639099), ('taoist', 0.9232008592910849), ('old', 0.9342105263157895), ('older', 0.9315789473684211), ('young', 0.9331662489557226), ('younger', 0.9300751879699248), ('teenage', 0.8977443609022557), ('millenial', 0.9266917293233082), ('middle aged', 0.8969924812030075), ('elderly', 0.9236842105263158), ('blind', 0.88796992481203), ('deaf', 0.8285714285714285), ('paralyzed', 0.8409774436090225)], 'BNSP_AUC': [('lesbian', 0.8744939271255061), ('gay', 0.8863504916136495), ('bisexual', 0.8710237131289763), ('transgender', 0.8710237131289763), ('trans', 0.8289473684210527), ('queer', 0.8944476576055523), ('lgbt', 0.8010651629072681), ('lgbtq', 0.7967032967032966), ('homosexual', 0.9013880855986119), ('straight', 0.7432041642567958), ('heterosexual', 0.8733371891266628), ('male', 0.8549498746867168), ('female', 0.8637941006362059), ('nonbinary', 0.7767495662232503), ('african', 0.9827067669172931), ('african american', 0.9861372180451128), ('black', 0.9678101503759398), ('white', 0.9137687969924813), ('european', 0.950187969924812), ('hispanic', 0.8446898496240601), ('latino', 0.9447838345864662), ('latina', 0.8980263157894736), ('latinx', 0.9375), ('mexican', 0.8898026315789473), ('canadian', 0.9276315789473684), ('american', 0.9798245614035087), ('asian', 0.9283364661654134), ('indian', 0.9389097744360902), ('middle eastern', 0.8677161654135337), ('chinese', 0.9539473684210527), ('japanese', 0.9163533834586467), ('christian', 0.9828141783029002), ('muslim', 0.9607948442534909), ('jewish', 0.9108485499462943), ('buddhist', 0.9328678839957036), ('catholic', 0.8743286788399569), ('protestant', 0.9258861439312566), ('sikh', 0.9586466165413533), ('taoist', 0.9199785177228785), ('old', 0.8489974937343359), ('older', 0.8383458646616542), ('young', 0.8617376775271512), ('younger', 0.8533834586466167), ('teenage', 0.9533834586466166), ('millenial', 0.85), ('middle aged', 0.8864661654135338), ('elderly', 0.9172932330827068), ('blind', 0.9394736842105262), ('deaf', 0.975187969924812), ('paralyzed', 0.9627819548872181)]}


all_dictionaries = [FINAL_bert_ear_reg_0_00, FINAL_bert_ear_reg_0_01,
                    FINAL_xlnet_ear_reg_0_00, FINAL_xlnet_ear_reg_0_01]

output_dictionary = {'lesbian': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'gay': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'bisexual': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'transgender': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'trans': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'queer': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'lgbt': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'lgbtq': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'homosexual': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'straight': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'heterosexual': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'male': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'female': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'nonbinary': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'african': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'african american': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'black': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'white': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'european': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'hispanic': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'latino': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'latina': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'latinx': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'mexican': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'canadian': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []},
                     'american': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'asian': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'indian': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'middle eastern': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'chinese': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'japanese': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'christian': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'muslim': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'jewish': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'buddhist': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'catholic': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'protestant': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'sikh': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'taoist': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'old': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'older': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'young': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'younger': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'teenage': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'millenial': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'middle aged': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'elderly': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'blind': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'deaf': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}, 'paralyzed': {'BERT': [], 'BERT+EAR': [], 'XLNET': [], 'XLNET+EAR': []}}

for index, dictionary in enumerate(all_dictionaries):
    for metric in dictionary.keys():
        metric_values = dictionary[metric]
        for identity_value in metric_values:
            identity = identity_value[0]
            value = identity_value[1]
            if(index == 0):  # BERT
                output_dictionary[identity]['BERT'].append(value)
            elif(index == 1):  # BERT+EAR
                output_dictionary[identity]['BERT+EAR'].append(value)
            elif(index == 2):  # XLNET
                output_dictionary[identity]['XLNET'].append(value)
            elif(index == 3):  # XLNET+EAR
                output_dictionary[identity]['XLNET+EAR'].append(value)

# This way plots have bigger font size, and it looks better
plt.rcParams.update({'font.size': 18})


# This function outputs multiple bar charts in one image
def multiple_plots_granular(dictionary: dict):
    for identity in list(dictionary.keys())[14:31]:
        metrics = ("Subgroup AUC", "BPSN AUC", "BNSP AUC")
        models = {
            'BERT': dictionary[identity]['BERT'],
            'BERT+EAR': dictionary[identity]['BERT+EAR'],
            'XLNet': dictionary[identity]['XLNET'],
            'XLNet+EAR': dictionary[identity]['XLNET+EAR'],
        }
        x = np.arange(len(metrics))  # the label locations
        width = 0.20  # the width of the bars
        multiplier = 0
        colors = ['blue', 'darkblue', 'red', 'darkred']
        fig, ax = plt.subplots(layout='constrained')
        for attribute, measurement, color in zip(models.keys(), models.values(), colors):
            offset = width * multiplier
            rects = ax.bar(x + offset, measurement, width,
                           label=attribute, color=color)
            #ax.bar_label(rects, padding=4)
            multiplier += 1
        ax.set_title(identity.upper())
        ax.set_xticks(x + 0.30, metrics)
        ax.legend(loc='upper left', ncols=4)
        ax.set_ylim(0, 1.1)
        plt.show()


multiple_plots_granular(output_dictionary)
